const fs = require('fs');

module.exports = function(RED) {
    function fileExistsNode(config) {
        RED.nodes.createNode(this, config);
        var node = this;

        node.on("input", function(msg) {
            try {
                const filePath = msg.url; // 使用msg.url作为文件路径
                fs.access(filePath, fs.constants.F_OK, (err) => {
                    if (err) {
                        // 如果文件不存在，则返回false
                        msg.payload = false;
                        node.send(msg);
                    } else {
                        // 如果文件存在，则返回true
                        msg.payload = true;
                        node.send(msg);
                    }
                });
            } catch (error) {
                node.error(error);
            }
        });
    }

    RED.nodes.registerType("fileExists", fileExistsNode);
};